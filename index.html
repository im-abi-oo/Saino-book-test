<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>مانگا اپکس زنیت | نسخه ۱۶.۰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css" rel="stylesheet"/>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --primary: #00f2ff;
            --primary-glow: rgba(0, 242, 255, 0.4);
            --secondary: #7000ff;
            --bg-deep: #050508;
            --panel: rgba(13, 13, 20, 0.95);
            --border: rgba(255, 255, 255, 0.08);
        }

        * {
            scrollbar-width: thin;
            scrollbar-color: var(--primary) transparent;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: var(--bg-deep);
            color: #fff;
            margin: 0;
            overflow: hidden;
            background-attachment: fixed;
        }

        /* موتور رندرینگ صفحات */
        #viewport {
            width: 100vw;
            height: 100vh;
            overflow-y: scroll;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        .manga-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 80px 0;
            gap: 8px;
        }

        .page-wrapper {
            position: relative;
            width: 100%;
            transition: max-width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: #000;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .manga-img {
            width: 100%;
            height: auto;
            display: block;
            opacity: 0;
            transition: opacity 0.8s ease;
        }

        .manga-img.loaded { opacity: 1; }

        /* استایل پنل‌های شیشه‌ای (Glassmorphism) */
        .glass-panel {
            background: var(--panel);
            backdrop-filter: blur(20px) saturate(160%);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border);
        }

        /* طراحی اسلایدرهای مدرن */
        input[type=range] {
            -webkit-appearance: none;
            background: rgba(255,255,255,0.05);
            height: 6px;
            border-radius: 10px;
            width: 100%;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: var(--primary);
            box-shadow: 0 0 10px var(--primary-glow);
            cursor: pointer;
        }

        /* انیمیشن سایدبار */
        .sidebar {
            position: fixed;
            top: 0;
            bottom: 0;
            right: 0;
            width: 350px;
            z-index: 100;
            transform: translateX(100%);
            transition: transform 0.5s cubic-bezier(0.3, 1, 0.3, 1);
        }
        .sidebar.active { transform: translateX(0); }

        .chapter-item:hover {
            background: linear-gradient(90deg, rgba(0,242,255,0.1), transparent);
            border-right: 3px solid var(--primary);
        }

        /* نوار وضعیت بالا و پایین */
        .hud-top, .hud-bottom {
            transition: transform 0.4s ease, opacity 0.4s ease;
        }
        .hud-hidden { opacity: 0; pointer-events: none; }
        .hud-top.hud-hidden { transform: translateY(-100%); }
        .hud-bottom.hud-hidden { transform: translateY(100%); }

    </style>
</head>
<body>

    <!-- نوار پیشرفت -->
    <div class="fixed top-0 left-0 w-full h-1 z-[110] bg-black/20">
        <div id="progress-bar" class="h-full bg-cyan-400 shadow-[0_0_10px_#22d3ee] w-0 transition-all duration-150"></div>
    </div>

    <!-- بخش HUD بالا -->
    <header id="ui-top" class="hud-top fixed top-0 inset-x-0 z-50 p-4">
        <div class="max-w-5xl mx-auto flex items-center justify-between px-6 py-3 glass-panel rounded-2xl shadow-2xl">
            <div class="flex items-center gap-4">
                <button class="w-10 h-10 flex items-center justify-center rounded-xl bg-white/5 hover:bg-white/10">
                    <i data-lucide="chevron-right"></i>
                </button>
                <div>
                    <h1 class="text-sm font-bold text-white">نام مانگا: سولو لولینگ</h1>
                    <p class="text-[10px] text-cyan-400 font-mono">CHAPTER 178 • ZENITH ENGINE</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <div class="px-3 py-1 bg-white/5 rounded-lg border border-white/5 font-mono text-sm">
                    <span id="current-page">01</span> / <span id="total-pages">48</span>
                </div>
                <button onclick="toggleSidebar('chapters')" class="w-10 h-10 flex items-center justify-center rounded-xl bg-cyan-500/20 text-cyan-400 border border-cyan-500/30">
                    <i data-lucide="layers"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- محفظه اصلی صفحات -->
    <main id="viewport">
        <div id="manga-render" class="manga-container">
            <!-- صفحات اینجا تزریق می‌شوند -->
        </div>
        
        <!-- انتهای فصل -->
        <div class="py-20 flex flex-col items-center gap-4 opacity-30">
            <div class="w-12 h-12 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"></div>
            <span class="text-xs tracking-widest uppercase">پایان این بخش</span>
        </div>
    </main>

    <!-- بخش HUD پایین -->
    <footer id="ui-bottom" class="hud-bottom fixed bottom-6 inset-x-0 z-50 p-4">
        <div class="max-w-md mx-auto flex items-center justify-around px-4 py-3 glass-panel rounded-[2rem] shadow-2xl">
            <button class="w-12 h-12 flex items-center justify-center rounded-2xl hover:bg-white/5 text-zinc-400">
                <i data-lucide="skip-forward"></i>
            </button>
            
            <div class="h-8 w-px bg-white/10"></div>
            
            <button onclick="scrollToTop()" class="flex flex-col items-center gap-1 group">
                <i data-lucide="arrow-up" class="w-5 h-5 group-hover:-translate-y-1 transition-transform"></i>
                <span class="text-[9px] font-bold">بالا</span>
            </button>

            <button onclick="toggleSidebar('settings')" class="w-14 h-14 flex items-center justify-center rounded-full bg-cyan-500 text-black shadow-lg shadow-cyan-500/30">
                <i data-lucide="settings"></i>
            </button>

            <button onclick="toggleAutoScroll()" id="autoscroll-btn" class="flex flex-col items-center gap-1 group">
                <i data-lucide="play" class="w-5 h-5"></i>
                <span class="text-[9px] font-bold">اتوپلی</span>
            </button>

            <div class="h-8 w-px bg-white/10"></div>

            <button class="w-12 h-12 flex items-center justify-center rounded-2xl hover:bg-white/5 text-zinc-400">
                <i data-lucide="skip-back"></i>
            </button>
        </div>
    </footer>

    <!-- سایدبار فصل‌ها -->
    <aside id="side-chapters" class="sidebar glass-panel shadow-2xl">
        <div class="p-6 h-full flex flex-col">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-lg font-black text-cyan-400">فهرست فصل‌ها</h2>
                <button onclick="toggleSidebar('chapters')" class="w-8 h-8 flex items-center justify-center rounded-full bg-white/5"><i data-lucide="x" class="w-4 h-4"></i></button>
            </div>
            <div id="chapter-list" class="flex-1 overflow-y-auto space-y-2 pr-2">
                <!-- اسکریپت لیست را پر می‌کند -->
            </div>
        </div>
    </aside>

    <!-- سایدبار تنظیمات -->
    <aside id="side-settings" class="sidebar glass-panel shadow-2xl">
        <div class="p-8 h-full flex flex-col">
            <div class="flex items-center justify-between mb-10">
                <h2 class="text-lg font-black">تنظیمات پیشرفته</h2>
                <button onclick="toggleSidebar('settings')" class="w-8 h-8 flex items-center justify-center rounded-full bg-white/5"><i data-lucide="x" class="w-4 h-4"></i></button>
            </div>

            <div class="space-y-10">
                <!-- نوار لغزنده عرض -->
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <label class="text-xs font-bold text-zinc-400">عرض تصاویر مانگا</label>
                        <span id="width-val" class="text-xs text-cyan-400 font-mono">900px</span>
                    </div>
                    <input type="range" id="width-slider" min="400" max="1400" value="900" oninput="updateWidth(this.value)">
                </div>

                <!-- نوار لغزنده اسکرول -->
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <label class="text-xs font-bold text-zinc-400">سرعت اسکرول خودکار</label>
                        <span id="scroll-val" class="text-xs text-cyan-400 font-mono">2x</span>
                    </div>
                    <input type="range" id="scroll-slider" min="1" max="20" value="2" oninput="updateScrollSpeed(this.value)">
                </div>

                <!-- فیلترها -->
                <div class="space-y-4">
                    <label class="text-xs font-bold text-zinc-400">حالت نمایشی تصویر</label>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="setFilter('none')" class="p-3 rounded-xl bg-white/5 border border-white/5 text-[10px] active-filter">استاندارد</button>
                        <button onclick="setFilter('sepia(0.3)')" class="p-3 rounded-xl bg-white/5 border border-white/5 text-[10px]">حالت کاغذی</button>
                        <button onclick="setFilter('contrast(1.2) grayscale(1)')" class="p-3 rounded-xl bg-white/5 border border-white/5 text-[10px]">سیاه و سفید</button>
                        <button onclick="setFilter('brightness(0.7)')" class="p-3 rounded-xl bg-white/5 border border-white/5 text-[10px]">حالت شب</button>
                    </div>
                </div>

                <!-- سوئیچ‌ها -->
                <div class="flex items-center justify-between p-4 bg-white/5 rounded-2xl">
                    <span class="text-xs">بارگذاری سریع (Turbo)</span>
                    <div class="w-10 h-5 bg-cyan-500 rounded-full flex items-center px-1"><div class="w-3 h-3 bg-white rounded-full"></div></div>
                </div>
            </div>

            <div class="mt-auto text-center opacity-20 text-[10px]">
                ZENITH CORE v16.0.2 - STABLE
            </div>
        </div>
    </aside>

    <!-- لایه کلیک برای مخفی کردن HUD -->
    <div id="click-zone" class="fixed inset-0 z-40 pointer-events-none">
        <div class="absolute inset-y-0 left-0 w-24 pointer-events-auto" onclick="changePage(-1)"></div>
        <div class="absolute inset-y-0 right-0 w-24 pointer-events-auto" onclick="changePage(1)"></div>
        <div class="absolute inset-0 m-auto w-1/2 h-1/2 pointer-events-auto" onclick="toggleHUD()"></div>
    </div>

    <script>
        const state = {
            pages: 48,
            current: 1,
            hud: true,
            autoScroll: false,
            scrollSpeed: 2,
            width: 900,
            images: Array.from({length: 48}, (_, i) => `https://picsum.photos/id/${(i+60)*2}/1000/1500`)
        };

        const vport = document.getElementById('viewport');
        const render = document.getElementById('manga-render');
        const progress = document.getElementById('progress-bar');
        
        function init() {
            lucide.createIcons();
            initPages();
            initChapters();
            setupScrollListener();
        }

        function initPages() {
            render.innerHTML = '';
            state.images.forEach((src, i) => {
                const wrapper = document.createElement('div');
                wrapper.className = 'page-wrapper';
                wrapper.style.maxWidth = state.width + 'px';
                
                const img = document.createElement('img');
                img.className = 'manga-img';
                img.dataset.src = src;
                img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';
                
                const observer = new IntersectionObserver(entries => {
                    entries.forEach(e => {
                        if(e.isIntersecting) {
                            e.target.src = e.target.dataset.src;
                            e.target.onload = () => e.target.classList.add('loaded');
                            observer.unobserve(e.target);
                        }
                    });
                }, { rootMargin: '800px' });

                observer.observe(img);
                wrapper.appendChild(img);
                render.appendChild(wrapper);
            });
        }

        function initChapters() {
            const list = document.getElementById('chapter-list');
            for(let i=178; i > 160; i--) {
                const item = document.createElement('div');
                item.className = 'chapter-item p-4 rounded-xl cursor-pointer flex justify-between items-center transition-all bg-white/2';
                item.innerHTML = `
                    <div class="flex flex-col">
                        <span class="text-xs font-bold text-zinc-200">فصل ${i}</span>
                        <span class="text-[9px] text-zinc-500 italic">نام چپتر به فارسی</span>
                    </div>
                    <i data-lucide="play-circle" class="w-4 h-4 text-zinc-600"></i>
                `;
                list.appendChild(item);
            }
            lucide.createIcons();
        }

        function setupScrollListener() {
            vport.addEventListener('scroll', () => {
                const pos = vport.scrollTop;
                const total = vport.scrollHeight - vport.clientHeight;
                const p = (pos / total) * 100;
                progress.style.width = p + '%';

                // آپدیت شماره صفحه
                const frames = document.querySelectorAll('.page-wrapper');
                frames.forEach((f, i) => {
                    const rect = f.getBoundingClientRect();
                    if(rect.top < window.innerHeight/2 && rect.bottom > window.innerHeight/2) {
                        state.current = i + 1;
                        document.getElementById('current-page').innerText = String(state.current).padStart(2, '0');
                    }
                });
            });
        }

        function updateWidth(val) {
            state.width = val;
            document.getElementById('width-val').innerText = val + 'px';
            document.querySelectorAll('.page-wrapper').forEach(p => p.style.maxWidth = val + 'px');
        }

        function updateScrollSpeed(val) {
            state.scrollSpeed = val;
            document.getElementById('scroll-val').innerText = val + 'x';
        }

        function toggleAutoScroll() {
            state.autoScroll = !state.autoScroll;
            const btn = document.getElementById('autoscroll-btn');
            if(state.autoScroll) {
                btn.classList.add('text-cyan-400');
                btn.querySelector('i').setAttribute('data-lucide', 'pause');
                autoScrollAction();
            } else {
                btn.classList.remove('text-cyan-400');
                btn.querySelector('i').setAttribute('data-lucide', 'play');
            }
            lucide.createIcons();
        }

        function autoScrollAction() {
            if(!state.autoScroll) return;
            vport.scrollBy(0, 1 * (state.scrollSpeed / 2));
            requestAnimationFrame(autoScrollAction);
        }

        function setFilter(f) {
            render.style.filter = f;
            document.querySelectorAll('.active-filter').forEach(b => b.classList.remove('active-filter', 'bg-cyan-500', 'text-black'));
            event.target.classList.add('active-filter', 'bg-cyan-500', 'text-black');
        }

        function toggleSidebar(id) {
            const el = document.getElementById(`side-${id}`);
            el.classList.toggle('active');
        }

        function toggleHUD() {
            state.hud = !state.hud;
            document.getElementById('ui-top').classList.toggle('hud-hidden');
            document.getElementById('ui-bottom').classList.toggle('hud-hidden');
        }

        function scrollToTop() {
            vport.scrollTo({top: 0, behavior: 'smooth'});
        }

        window.onload = init;
    </script>
</body>
</html>
